# å®éªŒ1: ä½¿ç”¨ç”¨æˆ·æ± ç®¡æ§æ™ºèƒ½ä½“è®¿é—®

> 10 åˆ†é’Ÿå†…ä¸ºæ‚¨çš„æ™ºèƒ½ä½“é…ç½®ä¼ä¸šçº§è®¿é—®æ§åˆ¶

## ä¸ºä»€ä¹ˆéœ€è¦ Inbound è®¤è¯ï¼Ÿ

### å…ˆæƒ³ä¸€ä¸ªé—®é¢˜

ä½ å†™äº†ä¸€ä¸ª Agentï¼Œæœ¬åœ°è·‘å¾—å¾ˆå¥½ã€‚ç°åœ¨è¦ä¸Šçº¿ç»™ç”¨æˆ·ç”¨äº†ã€‚

è¿™æ—¶å€™ä½ ä¼šé‡åˆ°ä¸€ä¸ªæœ€åŸºæœ¬çš„é—®é¢˜ï¼š**è°èƒ½è°ƒç”¨ä½ çš„ Agentï¼Ÿ**

### æ²¡æœ‰è®¤è¯ä¼šæ€æ ·ï¼Ÿ

**åœºæ™¯ 1ï¼šè£¸å¥”çš„ Agent**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸŒ äº’è”ç½‘  â”‚ â”€â”€â”€â”€â”€â”€â–¶ â”‚ ğŸ¤– ä½ çš„Agent â”‚ â”€â”€â”€â”€â”€â”€â–¶ â”‚ ğŸ’° æ¨¡å‹API  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                          æŒ‰Tokenè®¡è´¹
       â”‚
       â””â”€â”€â”€â”€ âš ï¸ ä»»ä½•äººéƒ½èƒ½è°ƒç”¨ï¼
```

åæœï¼š
- æœ‰äººå†™ä¸ªè„šæœ¬ç–¯ç‹‚è°ƒç”¨ï¼Œä½ çš„ API è´¹ç”¨ä¸€å¤œçˆ†ç‚¸
- ç«äº‰å¯¹æ‰‹æ‹¿ä½ çš„ Agent åšé€†å‘å·¥ç¨‹
- å‡ºäº†å®‰å…¨äº‹æ•…ï¼Œä½ ä¸çŸ¥é“æ˜¯è°å¹²çš„

**åœºæ™¯ 2ï¼šAgent ä¸çŸ¥é“"ä½ æ˜¯è°"**

å¾ˆå¤š Agent éœ€è¦æ ¹æ®ç”¨æˆ·èº«ä»½æä¾›ä¸ªæ€§åŒ–æœåŠ¡ï¼š
- æŸ¥"æˆ‘çš„è®¢å•" â€”â€” å“ªä¸ª"æˆ‘"ï¼Ÿ
- è®¿é—®"æˆ‘çš„æ–‡æ¡£" â€”â€” å“ªä¸ª"æˆ‘"ï¼Ÿ
- æ‰§è¡Œæ•æ„Ÿæ“ä½œ â€”â€” ä½ æœ‰æƒé™å—ï¼Ÿ

æ²¡æœ‰èº«ä»½ä¿¡æ¯ï¼ŒAgent è¦ä¹ˆæ‹’ç»æœåŠ¡ï¼Œè¦ä¹ˆåªèƒ½æä¾›æœ€åŸºç¡€çš„å…¬å¼€åŠŸèƒ½ã€‚

**åœºæ™¯ 3ï¼šå®¡è®¡å’Œåˆè§„**

å®‰å…¨å›¢é˜Ÿã€CISO ä¼šé—®ä½ ï¼š
- è¿™ä¸ª Agent è°åœ¨ç”¨ï¼Ÿ
- ç”¨äº†å¤šå°‘æ¬¡ï¼Ÿ
- æœ‰æ²¡æœ‰å¼‚å¸¸è°ƒç”¨ï¼Ÿ

ä½ ç­”ä¸ä¸Šæ¥ï¼Œåˆè§„å®¡è®¡ç›´æ¥æŒ‚æ‰ã€‚é‡‘èã€åŒ»ç–—ã€æ”¿ä¼å®¢æˆ·æ ¹æœ¬ä¸ä¼šç”¨ã€‚

### æ ¸å¿ƒé—®é¢˜ï¼šå…¥ç«™èº«ä»½

æŠŠé“¾è·¯ç”»å‡ºæ¥å°±å¾ˆæ¸…æ¥šï¼š

```
                    â“ ä½ æ˜¯è°ï¼Ÿ
                    â“ ä½ æœ‰æƒé™å—ï¼Ÿ
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ‘¤ ç”¨æˆ· â”‚ â”€â”€â”€â–¶ â”‚ ğŸ“± åº”ç”¨ â”‚ â”€â”€â”€â–¶ â”‚ ğŸ¤–Agentâ”‚ â”€â”€â”€â–¶ â”‚ ğŸ“¦ èµ„æº â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

è¿™å°±æ˜¯ **Inboundï¼ˆå…¥ç«™ï¼‰è®¤è¯** è¦è§£å†³çš„äº‹ï¼š
1. **è®¤è¯**ï¼šè¯æ˜"ä½ æ˜¯ä½ "
2. **æˆæƒ**ï¼šç¡®è®¤"ä½ èƒ½ç”¨"
3. **ä¼ é€’**ï¼šæŠŠèº«ä»½ä¿¡æ¯å¸¦ç»™ Agent

### Agent Identity æ€ä¹ˆè§£å†³ï¼Ÿ

æˆ‘ä»¬æä¾›å¼€ç®±å³ç”¨çš„ **ç”¨æˆ·æ± ** æ–¹æ¡ˆï¼š

| èƒ½åŠ› | è¯´æ˜ |
|------|------|
| **ç»Ÿä¸€ç”¨æˆ·ç›®å½•** | ä¸€ä¸ªåœ°æ–¹ç®¡ç†æ‰€æœ‰èƒ½è®¿é—® Agent çš„ç”¨æˆ· |
| **æ ‡å‡†åè®®** | OAuth2/OIDCï¼Œä¸ç”¨è‡ªå·±é€ è½®å­ |
| **JWT Token** | æ— çŠ¶æ€è®¤è¯ï¼Œé«˜æ€§èƒ½ï¼Œèº«ä»½ä¿¡æ¯å¯ä¼ é€’ç»™ Agent |
| **ä¼ä¸šçº§å®‰å…¨** | æ”¯æŒ MFAã€å¯†ç ç­–ç•¥ã€ç™»å½•å®¡è®¡ |

é…ç½®å®Œæˆåï¼Œè°ƒç”¨é“¾è·¯å˜æˆï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        è®¤è¯æµç¨‹                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  ğŸ‘¤ ç”¨æˆ·  â”€â”€â”€â–¶  ğŸ” ç™»å½•ç”¨æˆ·æ±   â”€â”€â”€â–¶  ğŸ« æ‹¿åˆ°Token               â”‚
â”‚                                          â”‚                     â”‚
â”‚                                          â–¼                     â”‚
â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚                              â”‚  ğŸ“¤ å¸¦Tokenè°ƒç”¨    â”‚             â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                        â”‚                       â”‚
â”‚                                        â–¼                       â”‚
â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚                              â”‚    ğŸ¤– Agent       â”‚             â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                        â”‚                       â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚                    â–¼                   â–¼                   â–¼   â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚              â”‚âœ… éªŒè¯   â”‚       â”‚ğŸ‘ï¸ çŸ¥é“è° â”‚       â”‚ğŸ“ å®¡è®¡   â”‚â”‚
â”‚              â”‚  Token   â”‚       â”‚  åœ¨è°ƒç”¨  â”‚       â”‚  æ—¥å¿—    â”‚â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**10 åˆ†é’Ÿé…ç½®ï¼Œè§£å†³ä¸‰ä¸ªé—®é¢˜ï¼šè°èƒ½ç”¨ã€è°åœ¨ç”¨ã€ç”¨äº†ä»€ä¹ˆã€‚**

---

## å¿«é€Ÿå¼€å§‹

### æ­¥éª¤1: åˆ›å»ºç”¨æˆ·æ± å’Œç”¨æˆ·ï¼ˆæ§åˆ¶å°æ“ä½œï¼‰

1. **è®¿é—® Agent Identity æ§åˆ¶å°**

   æ‰“å¼€ [ç”¨æˆ·æ± ç®¡ç†é¡µé¢](https://console.volcengine.com/identity/region:identity+cn-beijing/user-pools)

2. **æ–°å»ºç”¨æˆ·æ± **
   - ç‚¹å‡»ã€Œæ–°å»ºç”¨æˆ·æ± ã€
   - å¡«å†™ç”¨æˆ·æ± åç§°ï¼ˆå¦‚ `my_agent_users`ï¼‰
   - é€‰æ‹©ç™»å½•å±æ€§ï¼šç”¨æˆ·å + æ‰‹æœºå·
   - ç‚¹å‡»ã€Œç¡®è®¤ã€

3. **æ–°å»ºå®¢æˆ·ç«¯**
   - è¿›å…¥ç”¨æˆ·æ± è¯¦æƒ… â†’ ç‚¹å‡»ã€Œæ–°å»ºå®¢æˆ·ç«¯ã€
   - å®¢æˆ·ç«¯åç§°ï¼š`agent_web_client`
   - å®¢æˆ·ç«¯ç±»å‹ï¼šWeb åº”ç”¨
   - å›è°ƒåœ°å€ï¼š`http://127.0.0.1:8000/api/v1/oauth2callback`
   - **è®°å½• Client ID å’Œ Client Secret**

4. **åˆ›å»ºæµ‹è¯•ç”¨æˆ·**
   - åœ¨ç”¨æˆ·æ± ä¸­é€‰æ‹©ã€Œç”¨æˆ·ç®¡ç†ã€â†’ã€Œæ–°å»ºç”¨æˆ·ã€
   - è®¾ç½®ç”¨æˆ·åå’Œä¸´æ—¶å¯†ç 

[TODO: æ§åˆ¶å°æˆªå›¾]

### æ­¥éª¤2: é…ç½®ç¯å¢ƒå˜é‡

å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿å¹¶å¡«å†™ï¼š

```bash
cp .env.template .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š

```bash
# ç”¨æˆ·æ± é…ç½®ï¼ˆä»æ§åˆ¶å°å¤åˆ¶ï¼‰
ADK_OAUTH2_USERPOOL_UID=your-userpool-uid
ADK_OAUTH2_CLIENT_ID=your-client-id
ADK_OAUTH2_CLIENT_SECRET=your-client-secret
ADK_OAUTH2_CALLBACK_URL=http://127.0.0.1:8000/api/v1/oauth2callback
ADK_OAUTH2_SCOPE="openid profile"

# ç«å±±äº‘å‡­è¯
VOLCENGINE_ACCESS_KEY=your-access-key
VOLCENGINE_SECRET_KEY=your-secret-key
```

### æ­¥éª¤3: å¯åŠ¨ Agent åº”ç”¨

```bash
# å®‰è£…ä¾èµ–ï¼ˆé¦–æ¬¡è¿è¡Œï¼‰
uv sync

# å¯åŠ¨æœåŠ¡
uv run veadk web
```

æœåŠ¡å¯åŠ¨åï¼Œè®¿é—® http://127.0.0.1:8000

### æ­¥éª¤4: ç”¨æˆ·ç™»å½•ä½“éªŒ

1. **è®¿é—®åº”ç”¨** - æµè§ˆå™¨æ‰“å¼€ http://127.0.0.1:8000
2. **è·³è½¬ç™»å½•** - è‡ªåŠ¨è·³è½¬åˆ°ç”¨æˆ·æ± ç™»å½•é¡µé¢
3. **è¾“å…¥å‡­è¯** - ä½¿ç”¨æ­¥éª¤1åˆ›å»ºçš„ç”¨æˆ·ç™»å½•
4. **é¦–æ¬¡ä¿®æ”¹å¯†ç ** - å¦‚æœ‰è¦æ±‚ï¼Œè®¾ç½®æ–°å¯†ç 
5. **æˆæƒç¡®è®¤** - å…è®¸åº”ç”¨è®¿é—®æ‚¨çš„ä¿¡æ¯
6. **è¿›å…¥åº”ç”¨** - ç™»å½•æˆåŠŸï¼Œå¯ä»¥å¼€å§‹ä½¿ç”¨ Agent

```
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  ğŸš« æœªæˆæƒè®¿é—®  â”€â”€â”€â”€ 401 â”€â”€â”€â”€â–¶  âŒ Unauthorized  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  âœ… æˆæƒè®¿é—®    â”€â”€â”€â”€ 200 â”€â”€â”€â”€â–¶  ğŸ‰ æ­£å¸¸å“åº”      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å–ç‚¹è¯æœ¯

> **ç»™é”€å”®/PDSA çš„å‚è€ƒè¯æœ¯ï¼š**
>
> "é€šè¿‡ Agent Identityï¼Œæ‚¨å¯ä»¥åœ¨ **10 åˆ†é’Ÿå†…**ä¸ºæ™ºèƒ½ä½“é…ç½®ä¼ä¸šçº§è®¿é—®æ§åˆ¶ï¼Œ
> ç¡®ä¿åªæœ‰æˆæƒç”¨æˆ·æ‰èƒ½ä½¿ç”¨ Agent æœåŠ¡ã€‚
>
> - **å®‰å…¨åˆè§„**ï¼šæ»¡è¶³é‡‘èã€åŒ»ç–—ç­‰è¡Œä¸šçš„èº«ä»½è®¤è¯è¦æ±‚
> - **ç»Ÿä¸€ç®¡ç†**ï¼šé›†ä¸­ç®¡ç†ç”¨æˆ·ï¼Œæ”¯æŒ MFA äºŒæ¬¡éªŒè¯
> - **æ— ç¼é›†æˆ**ï¼šæ ‡å‡† OAuth2 åè®®ï¼Œæ˜“äºä¸ç°æœ‰ç³»ç»Ÿå¯¹æ¥
> - **å®¡è®¡è¿½æº¯**ï¼šæ¯æ¬¡è®¿é—®éƒ½æœ‰è®°å½•ï¼Œæ»¡è¶³å®¡è®¡éœ€æ±‚"

---

## æ ¸å¿ƒä»£ç è§£æ

```python
# main.py æ ¸å¿ƒé…ç½®

from veadk import Agent, Runner

# Agent å®šä¹‰
agent = Agent(
    name="my_secure_agent",
    model_name="doubao-seed-1-6-250615",
    instruction="ä½ æ˜¯ä¸€ä¸ªå®‰å…¨çš„æ™ºèƒ½åŠ©æ‰‹..."
)

runner = Runner(agent=agent)

# å¯åŠ¨å‘½ä»¤è‡ªåŠ¨é›†æˆ Inbound è®¤è¯
# uv run veadk web --config ...
```

**å…³é”®ç‚¹è¯´æ˜ï¼š**
- `veadk web` å‘½ä»¤è‡ªåŠ¨è¯»å–ç¯å¢ƒå˜é‡ä¸­çš„ OAuth2 é…ç½®
- æ‰€æœ‰è¯·æ±‚éƒ½ä¼šéªŒè¯ JWT Token
- æœªæˆæƒè¯·æ±‚è¿”å› 401 é”™è¯¯

---

## è¿›é˜¶: ä¸é£ä¹¦/ä¼ä¸š IdP é›†æˆ

æƒ³è®©ç”¨æˆ·ä½¿ç”¨é£ä¹¦è´¦å·ç™»å½•ï¼Ÿè¯·å‚è€ƒï¼š

â†’ [å®éªŒ2: é£ä¹¦ IdP è”åˆç™»å½•](../tutorial-2-feishu-idp/README.md)

æƒ³è®© Agent å®‰å…¨è®¿é—®é£ä¹¦æ–‡æ¡£ï¼Ÿè¯·å‚è€ƒï¼š

â†’ [å®éªŒ3: è®©æ™ºèƒ½ä½“å®‰å…¨è®¿é—®é£ä¹¦æ–‡æ¡£](../tutorial-3-feishu-outbound/README.md)

---

## å¸¸è§é—®é¢˜

| é—®é¢˜ | è§£å†³æ–¹æ¡ˆ |
|------|----------|
| ç™»å½•é¡µé¢ä¸€ç›´è·³è½¬ | æ¸…é™¤æµè§ˆå™¨ç¼“å­˜ï¼Œæ£€æŸ¥å›è°ƒåœ°å€é…ç½® |
| Token è¿‡æœŸ | é»˜è®¤ 10 å°æ—¶æœ‰æ•ˆï¼Œå¯é…ç½®åˆ·æ–°æœºåˆ¶ |
| å¿˜è®° Client Secret | åœ¨æ§åˆ¶å°é‡æ–°ç”Ÿæˆ |

---

## ç›¸å…³èµ„æº

- [Agent Identity äº§å“æ–‡æ¡£](https://www.volcengine.com/docs/identity)
- [VeADK å¼€å‘æŒ‡å—](https://volcengine.github.io/agentkit-sdk-python/)
